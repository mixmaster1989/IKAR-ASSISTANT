# üß† –†–ï–ó–Æ–ú–ï: –°–∏—Å—Ç–µ–º–∞ –ø–∞–º—è—Ç–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞

## üéØ –ü—Ä–æ–±–ª–µ–º–∞
–ë–æ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —É–ø–æ–º–∏–Ω–∞–ª –ø—Ä–æ—à–ª—ã–µ —Å–æ–±—ã—Ç–∏—è –≤ –æ—Ç–≤–µ—Ç–∞—Ö, —á—Ç–æ –¥–µ–ª–∞–ª–æ –µ–≥–æ –æ—Ç–≤–µ—Ç—ã –∑–∞–≤–∏—Å–∏–º—ã–º–∏ –æ—Ç "—á–∞–Ω–∫–æ–≤" –∏—Å—Ç–æ—Ä–∏–∏.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ
–°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ø–∞–º—è—Ç–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–Ω–∏—Ç **–∫—Ç–æ** –±–æ—Ç, –Ω–æ –Ω–µ **—á—Ç–æ** –æ–Ω –≥–æ–≤–æ—Ä–∏–ª.

## üîß –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. `backend/api/group_bot_trigger.py`
```python
# –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ø–∞–º—è—Ç–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞
character_memory = {}  # {chat_id: {"personality_traits": [], "key_events": [], "relationships": {}, "last_update": timestamp}}

# –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:
- _get_character_memory()     # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
- _update_character_memory()  # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π  
- _build_character_context()  # –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –±–µ–∑ —Å–æ–±—ã—Ç–∏–π
- _analyze_chat_for_character() # –ê–Ω–∞–ª–∏–∑ —á–∞—Ç–∞
```

### 2. `backend/admin_prompts.json`
```json
"group_bot_trigger": {
  "system_prompt": "...\nüé≠ –í–ê–ñ–ù–û –û –ü–ê–ú–Ø–¢–ò:\n- –£ —Ç–µ–±—è –µ—Å—Ç—å –ø–∞–º—è—Ç—å –æ —Å–≤–æ–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–µ –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö\n- –ù–ï —É–ø–æ–º–∏–Ω–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–æ—à–ª—ã–µ —Å–æ–±—ã—Ç–∏—è –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è\n- –ü—Ä–æ—Å—Ç–æ –±—É–¥—å —Å–æ–±–æ–π, —É—á–∏—Ç—ã–≤–∞—è —Å–≤–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä\n- –û—Ç–≤–µ—á–∞–π –Ω–∞ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç, –∞ –Ω–µ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—é\n...",
  "user_prompt": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç —Ç–µ–±–µ —Å–æ–æ–±—â–µ–Ω–∏–µ. –û—Ç–≤–µ—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —á–µ–ª–æ–≤–µ—á–Ω–æ, –Ω–æ –Ω–µ —Å—Å—ã–ª–∞–π—Å—è –Ω–∞ –ø—Ä–æ—à–ª—ã–µ —Å–æ–±—ã—Ç–∏—è."
}
```

### 3. –£–º–µ–Ω—å—à–µ–Ω –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏—Å—Ç–æ—Ä–∏–∏
- **–ë—ã–ª–æ**: 30 —Å–æ–æ–±—â–µ–Ω–∏–π
- **–°—Ç–∞–ª–æ**: 10 —Å–æ–æ–±—â–µ–Ω–∏–π

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç
- ‚úÖ –ë–æ—Ç –ø–æ–º–Ω–∏—Ç —Å–≤–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä
- ‚úÖ –ù–ï —É–ø–æ–º–∏–Ω–∞–µ—Ç –ø—Ä–æ—à–ª—ã–µ —Å–æ–±—ã—Ç–∏—è  
- ‚úÖ –û—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å

## üöÄ –î–µ–ø–ª–æ–π
1. `git add . && git commit -m "–î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ø–∞–º—è—Ç–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞" && git push`
2. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ: `git pull && systemctl restart ikar-bot`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `tail -f /var/log/ikar-bot.log`

## üß™ –¢–µ—Å—Ç
```bash
python test_character_memory_simple.py
```

---
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é 
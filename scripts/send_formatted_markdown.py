import os
import asyncio
import sys
from typing import Optional

# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø—É—Ç—å –¥–ª—è –∏–º–ø–æ—Ä—Ç–æ–≤ –º–æ–¥—É–ª—è backend
CURRENT_DIR = os.path.dirname(__file__)
PROJECT_ROOT = os.path.abspath(os.path.join(CURRENT_DIR, '..'))
if PROJECT_ROOT not in sys.path:
    sys.path.append(PROJECT_ROOT)

# –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞, —á—Ç–æ–±—ã –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∏–º–ø–æ—Ä—Ç–æ–≤
from backend.utils.text_formatters import send_formatted_markdown_to_telegram


def read_env_value(*keys: str) -> Optional[str]:
    """–ß–∏—Ç–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ –∏–∑ —Ñ–∞–π–ª–∞ .env –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞."""
    # 1) –°–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞–µ–º—Å—è –∏–∑ env
    for k in keys:
        val = os.getenv(k)
        if val:
            return val
    # 2) –ü—Ä–æ–±—É–µ–º –ø—Ä–æ—á–∏—Ç–∞—Ç—å .env –≤—Ä—É—á–Ω—É—é
    env_path = os.path.join(os.path.dirname(os.path.dirname(__file__)), '.env')
    if os.path.exists(env_path):
        try:
            with open(env_path, 'r', encoding='utf-8') as f:
                for line in f:
                    line = line.strip()
                    if not line or line.startswith('#') or '=' not in line:
                        continue
                    name, value = line.split('=', 1)
                    name = name.strip()
                    value = value.strip().strip('"').strip("'")
                    if name in keys and value:
                        return value
        except Exception:
            pass
    return None


RAW = r"""üìå **–ö—Ä–∞—Ç–∫–æ –æ –¥–≤—É—Ö ¬´—Å–µ–º–µ–π—Å—Ç–≤–µ¬ª –∫–∞—Å—Å**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | **Evotor** | **Atol‚ÄØSigma** |
|----------|------------|----------------|
| **–≠–∫—Ä–∞–Ω** | 5‚Äë7‚Ä≥ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç) / 10‚Ä≥ (HoReCa) | 7‚Ä≥ /¬†8‚Ä≥ /¬†10‚Ä≥ |
| **–ü–µ—á–∞—Ç–Ω–∞—è –≥–æ–ª–æ–≤–∫–∞** | –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ç–µ—Ä–º–æ–ø—Ä–∏–Ω—Ç–µ—Ä‚ÄëAPS‚ÄØSS205‚ÄëV4‚ÄëLV (57‚ÄØ–º–º) | –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø—Ä–∏–Ω—Ç–µ—Ä‚Äë–ø—Ä–æ—Ç–æ—Ç–∏–ø —Å –∞–≤—Ç–æ–æ—Ç—Ä–µ–∑—á–∏–∫–æ–º |
| **USB‚Äë–ø–æ—Ä—Ç—ã** | 1‚Äì6‚ÄØ–ø–æ—Ä—Ç–æ–≤ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –º–æ–¥–µ–ª–∏) | 4‚Äì6‚ÄØ–ø–æ—Ä—Ç–æ–≤ |
| **Wi‚ÄëFi / GSM** | –î–∞ –Ω–∞ –≤—Å–µ—Ö –º–æ–¥–µ–ª—è—Ö | –î–∞ –Ω–∞ –≤—Å–µ—Ö –º–æ–¥–µ–ª—è—Ö |
| **–ë–∞—Ç–∞—Ä–µ—è** | –î–æ‚ÄØ12‚ÄØ—á –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç–∏ (–º–æ–¥–µ–ª–∏ —Å –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–æ–º) | –î–æ‚ÄØ5‚Äì8‚ÄØ—á –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç–∏ |
| **–§–∏—Å–∫–∞–ª—å–Ω—ã–π –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å** | –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∏–ª–∏ –≤–Ω–µ—à–Ω–∏–π –ø–æ –≤—ã–±–æ—Ä—É (FN15/FN36) | –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∏–ª–∏ –≤–Ω–µ—à–Ω–∏–π –ø–æ –≤—ã–±–æ—Ä—É |
| **–¶–µ–Ω–∞ –±–µ–∑ FN** | –û—Ç‚ÄØ24‚ÄØ900 ‚ÇΩ –¥–æ¬†38‚ÄØ900 ‚ÇΩ* | –û—Ç¬†21¬†500 ‚ÇΩ –¥–æ¬†33¬†000 ‚ÇΩ* |

\* —Ü–µ–Ω—ã —É–∫–∞–∑–∞–Ω—ã –±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –§–ù –∏ –Ω–∞–ª–æ–≥–æ–≤—ã—Ö —É—Å–ª—É–≥

---

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–∞–∂–¥—É—é —Å–∏—Å—Ç–µ–º—É ¬´–æ—Å–æ–±–µ–Ω–Ω–æ–π¬ª

#### Evotor  
‚úÖ *–ú–æ–±–∏–ª—å–Ω–æ—Å—Ç—å* ‚Äì –ª—ë–≥–∫–∏–µ –º–æ–¥–µ–ª–∏ (5i/5/7.x) –≤–µ—Å–æ–º <0,9‚ÄØ–∫–≥ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –∫–∏–æ—Å–∫–æ–≤ –∏ –º–æ–±–∏–ª—å–Ω—ã—Ö —Ç–æ—á–µ–∫  
‚úÖ *–ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏* ‚Äì –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ñ–∏—Å–∫–∞–ª—å–Ω—ã–π –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å –∏ –±—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –û–§–î  
‚úÖ *–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ü–û* ‚Äì –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ —Å Frontol, Quick Resto –∏ –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ ¬´–ø—Ä–æ—Å—Ç–æ –∏–∑ –∫–æ—Ä–æ–±–∫–∏¬ª  
‚ùå *–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ –ø–æ—Ä—Ç–æ–≤* ‚Äì –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –ø–µ—Ä–∏—Ñ–µ—Ä–∏–∏ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–Ω–µ—à–Ω–∏–µ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç–æ—Ä—ã  
‚ùå *–°—Ç–æ–∏–º–æ—Å—Ç—å –§–ù+PK –º–æ–∂–µ—Ç –±—ã—Å—Ç—Ä–æ —Ä–∞—Å—Ç—è–≥–∏–≤–∞—Ç—å –±—é–¥–∂–µ—Ç*

#### Atol Sigma  
‚úÖ *–ì–∏–±–∫–æ—Å—Ç—å –ø–æ—Ä—Ç–æ–≤* ‚Äì –¥–æ —à–µ—Å—Ç–∏ USB‚Äë–ø–æ—Ä—Ç–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å –≤–µ—Å—ã, —Å–∫–∞–Ω–µ—Ä—ã —à—Ç—Ä–∏—Ö–∫–æ–¥–æ–≤ –∏ –¥–µ–Ω–µ–∂–Ω—ã–µ —è—â–∏–∫–∏ –±–µ–∑ –ª–∏—à–Ω–∏—Ö –∞–¥–∞–ø—Ç–µ—Ä–æ–≤  
‚úÖ *–ù–∞–¥—ë–∂–Ω—ã–π –∫–æ—Ä–ø—É—Å* ‚Äì –±–æ–ª–µ–µ —Ç—è–∂—ë–ª—ã–π –≤–µ—Å (~1 –∫–≥), –Ω–æ —É—Å—Ç–æ–π—á–∏–≤—ã–π –∫ —á–∞—Å—Ç–æ–º—É –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—é –≤ —Ç–æ—Ä–≥–æ–≤–æ–π —Ç–æ—á–∫–µ  
‚úÖ *–≠–∫–æ–Ω–æ–º–∏—á–Ω–æ—Å—Ç—å –±–∞–∑–æ–≤–æ–π —Ü–µ–Ω—ã* ‚Äì –º–æ–¥–µ–ª—å –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —É–∂–µ –æ—Ç ~21 —Ç—ã—Å., –∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ—Ä—Ç—ã —Å—Ç–æ—è—Ç –º–µ–Ω—å—à–µ —á–µ–º —É Evotor  
‚ùå *–ú–µ–Ω—å—à–∞—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å* ‚Äì –±–∞—Ç–∞—Ä–µ—è –Ω–µ —Ç–∞–∫ –¥–æ–ª–≥–æ –¥–µ—Ä–∂–∏—Ç—Å—è –∫–∞–∫ —É –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–æ–¥–µ–ª–µ–π Evotor  
‚ùå *–ú–µ–Ω–µ–µ ¬´–º–æ–±–∏–ª—å–Ω—ã–π¬ª –¥–∏–∑–∞–π–Ω* ‚Äì –±–æ–ª—å—à–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö —Ç–æ—á–µ–∫

---

### –ö–∞–∫–æ–π –≤—ã–±—Ä–∞—Ç—å?

ü§ù **–ï—Å–ª–∏ –≤–∞—à –±–∏–∑–Ω–µ—Å:**  

- –Ω–µ–±–æ–ª—å—à–∞—è —Ç–æ—á–∫–∞ –∏–ª–∏ –∫–∏–æ—Å–∫ ‚Üí **Evotor 5 –∏–ª–∏ 7.x** (–ª–µ–≥–∫–æ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è, –±—ã—Å—Ç—Ä–æ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è).  
- —Å—Ä–µ–¥–Ω–∏–π —Ä–∏—Ç–µ–π–ª —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–µ—Ä–∏—Ñ–µ—Ä–∏–π–Ω—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ ‚Üí **Atol Sigma¬†8 –∏–ª–∏¬†10** (–±–æ–ª—å—à–µ USB‚Äë–ø–æ—Ä—Ç–æ–≤).  
- HoReCa –∏–ª–∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º —Å—Ç–æ–ª–∏–∫–∞–º–∏ ‚Üí **Evotor¬†10**, –±–ª–∞–≥–æ–¥–∞—Ä—è –±–æ–ª—å—à–æ–º—É —ç–∫—Ä–∞–Ω—É –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å–∏—Å—Ç–µ–º–æ–π –∑–∞–∫–∞–∑–æ–≤.

üí¨ –ï—Å–ª–∏ –±—é–¥–∂–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –∏ –≤–∞–º –Ω—É–∂–Ω–∞ –ø—Ä–æ—Å—Ç–∞—è –∫–∞—Å—Å–∞ –±–µ–∑ –ª–∏—à–Ω–∏—Ö –ø–æ—Ä—Ç–æ–≤ ‚Äî –æ—Ç–¥–∞–π—Ç–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ **Atol Sigma¬†7**, –∞ –µ—Å–ª–∏ –≤–∞–∂–Ω–∞ –º–æ–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –±—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ ‚Äî –≤—ã–±–∏—Ä–∞–π—Ç–µ **Evotor¬†7.2**.

---

> _–ò–∫–∞—Ä –≤—Å–µ–≥–¥–∞ —Å–æ–≤–µ—Ç—É–µ—Ç —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ —Ç–æ—á–∫–∏ ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—á–∏—Ö –º–µ—Å—Ç, –Ω–∞–ª–∏—á–∏–µ –≤–µ—Å–æ–≤/—Å–∫–∞–Ω–µ—Ä–æ–≤ –∏ —Ç–∏–ø –ø—Ä–æ–¥–∞–∂._

üìπ   –º—ã –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø–æ–¥–æ–±–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –º–æ–¥–µ–ª–∏ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–ª –µ–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç–µ–ª–µ–≥—Ä–∞–º–æ–º–æ —Ñ–æ—Ä–º–∞—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–ª –æ—Ç–≤–µ—Ç –≤ –∫—Ä–∞—Å–∏–≤–æ–º —á–∏—Ç–∞–µ–º–æ–º–æ –≤–∏–¥–µ?
"""


async def main():
    chat_id = read_env_value('TELEGRAM_CHANNEL_ID', 'IKAR_TELEGRAM_GROUP_ID', 'TELEGRAM_GROUP_ID')
    if not chat_id:
        raise SystemExit('No chat_id found in env or .env')
    # –£—Å—Ç–∞–Ω–æ–≤–∏–º —Ç–æ–∫–µ–Ω –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–µ, —á—Ç–æ–±—ã –µ–≥–æ —É–≤–∏–¥–µ–ª telegram_core
    bot_token = read_env_value('TELEGRAM_BOT_TOKEN', 'BOT_TOKEN')
    if bot_token:
        os.environ['TELEGRAM_BOT_TOKEN'] = bot_token
    mid = await send_formatted_markdown_to_telegram(chat_id, RAW)
    print('sent', mid)


if __name__ == '__main__':
    asyncio.run(main())
